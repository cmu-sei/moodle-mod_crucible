define ("mod_crucible/tasks",["jquery","core/config","core/log"],function(a,b,c){var f,g,h;return{init:function init(b){console.log("scenario id "+b.scenario);f=b.scenario;g=b.attempt;h=b.cmid;d();setInterval(function(){d()},5e3);var c=document.getElementsByClassName("exec-task");a.each(c,function(a,b){var c=b.id,d=document.getElementById(c);if(d){if("Run Task"===d.innerHTML){d.onclick=function(){e(c)};console.log("set event for button "+c)}}})}};function d(){a.ajax({url:b.wwwroot+"/mod/crucible/getresults.php",dataType:"json",type:"POST",data:{sesskey:b.sesskey,time:a.now(),id:f,cmid:h,a:g},headers:{"Cache-Control":"no-cache",Expires:"-1"},success:function success(b){console.log(b);index=0;a.each(b.parsed,function(a,b){var c=document.getElementById("result-"+b.taskId);if(c&&b.status){c.innerHTML=b.status}var d=document.getElementById("score-"+b.taskId);if(d&&null!=typeof b.score){d.innerHTML=b.score}a++});var c=document.getElementById("attempt-score");if(c){c.innerHTML=b.score}},error:function error(a){console.log("error");console.log(a)}})}function e(d){console.log("exec task for "+d);a.ajax({url:b.wwwroot+"/mod/crucible/runtask.php",dataType:"json",type:"POST",data:{sesskey:b.sesskey,time:a.now(),id:d,a:g,cmid:h},headers:{"Cache-Control":"no-cache",Expires:"-1"},success:function success(a){console.log(a)},error:function error(a){console.log("crucible task failed");console.log(a);c.debug("moodle-mod_crucible-runtask: ".request)}})}});
//# sourceMappingURL=tasks.min.js.map
